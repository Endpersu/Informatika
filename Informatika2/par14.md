1. Почему невыгодно собирать все данные в одной таблице?

Собирать все данные в одной таблице во многих случаях невыгодно из-за:

Избыточности данных: Повторение одних и тех же данных в разных записях, что увеличивает размер базы данных и требует лишней памяти.
Несогласованности данных: При изменении данных в одном месте нужно вносить изменения во многих других, что повышает риск ошибок.
Сложности при добавлении данных: Увеличение числа полей, необходимых для разных типов данных, делает таблицу громоздкой и неудобной для добавления новых записей.
Медленный поиск: Поиск нужной информации в одной большой таблице происходит медленнее, чем в нескольких более маленьких.
Проблемы при модификации: Изменения структуры одной большой таблицы может потребовать больших усилий, чем изменения нескольких маленьких таблиц.
Трудности при работе с данными: Работа с таблицей, содержащей различные типы данных, становится сложной и затрудняет дальнейший анализ и использование данных.
2. Принцип разбиения данных на несколько таблиц

Данные разбиваются на несколько таблиц по принципу нормализации. При этом:

Сущности: Данные группируются по сущностям (объектам). Каждая сущность (например, “Клиент”, “Товар”, “Заказ”) представляется отдельной таблицей.
Атрибуты: Атрибуты (свойства) сущности (например, “Имя клиента”, “Цена товара”, “Дата заказа”) становятся полями таблицы.
Связи: Связи между сущностями устанавливаются с помощью ключей (например, “Клиент” может быть связан с “Заказом”).
Устранение избыточности: Данные не дублируются, а хранятся в единственном экземпляре, в соответствующей таблице.
Упрощение управления: Упрощается управление данными, так как каждая таблица содержит информацию только об одном виде сущностей.
Целостность: Упрощается обеспечение целостности данных.
3. Внешний ключ таблицы (Foreign Key)

Внешний ключ (Foreign Key) - это поле (или набор полей) в одной таблице, которое ссылается на первичный ключ другой таблицы. Внешний ключ устанавливает связь между двумя таблицами и обеспечивает целостность данных.

4. Ссылочная целостность БД и её обеспечение

Ссылочная целостность - это свойство базы данных, которое гарантирует, что связи между таблицами остаются корректными, т.е. значения внешних ключей соответствуют значениям первичных ключей в связанных таблицах. Ссылочная целостность обеспечивается СУБД через следующие механизмы:

Ограничения внешнего ключа (Foreign Key Constraints): При попытке добавить запись с внешним ключом, которого нет в первичной таблице, возникает ошибка.
Ограничение на удаление записей: При попытке удалить запись в первичной таблице, на которую ссылаются записи во вторичной таблице (т.е. имеют внешний ключ на эту запись), СУБД может запретить удаление или удалить связанные записи в другом таблице.
Каскадное обновление (CASCADE UPDATE): При изменении значения первичного ключа в главной таблице автоматически изменяются соответствующие значения внешнего ключа в связанных таблицах.
Каскадное удаление (CASCADE DELETE): При удалении записи из первичной таблицы автоматически удаляются все связанные с ней записи из вторичной таблицы.
Ограничение на изменение: Запрет изменения значений внешнего ключа, если они не соответствуют значениям первичного ключа.
5. Типы связей в многотабличных БД

В многотабличных базах данных используются следующие типы связей:

“Один к одному” (1:1): Одна запись в одной таблице соответствует только одной записи в другой таблице.
“Один ко многим” (1:N): Одна запись в одной таблице может соответствовать нескольким записям в другой таблице.
“Многие ко многим” (M:N): Несколько записей в одной таблице могут соответствовать нескольким записям в другой таблице.
6. Связь “1:1”

Применение: Связь “1:1” применяется в случаях, когда данные логически связаны, но хранение их в одной таблице нецелесообразно (например, из-за большого количества полей или необходимости разделения доступа к данным).
Связываемые поля: Связываются первичные ключи обеих таблиц. Один из ключей становится и внешним ключом в другой таблице.
7. Связь “1:N”

Применение: Связь “1:N” применяется, когда одна запись в одной таблице связана со многими записями в другой таблице (например, один клиент может сделать много заказов).
Связываемые поля: Связывается первичный ключ таблицы “один” (например, “Клиент”) и внешний ключ в таблице “многие” (например, “Заказы”), который ссылается на первичный ключ первой таблицы.
8. Связь через ключевые поля таблиц А и Б

Если таблицы А и Б связаны через свои ключевые поля, то это связь “1:1” или “1:N”.

“1:1” - если оба поля - первичные ключи.
“1:N” - если ключ таблицы А - первичный, а ключ таблицы Б - внешний ключ, ссылающийся на первичный ключ таблицы А.
9. Связь через ключевое поле Б и неключевое поле А

Связь между таблицами А и Б, установленная через ключевое поле таблицы Б и неключевое поле таблицы А, обычно не является стандартной связью.

Такая связь может быть реализована, но она не обеспечит ссылочную целостность в полной мере.
Это может быть связь типа “N:1”, где множество записей в таблице А может ссылаться на одну запись в таблице Б, при этом связь между этими таблицами должна быть организована через внешний ключ в таблице А, ссылающийся на первичный ключ таблицы Б, а в таблице А есть поле, которое не является уникальным и не используется как ключ.
10. Связь “M:N” в СУБД, которая её не поддерживает

Чтобы создать связь “многие ко многим” в СУБД, которая ее не поддерживает, используется промежуточная (связующая) таблицу. Эта таблица связывает записи из исходных таблиц, образуя связь “один-ко-многим” к каждой из них:

Создание связующей таблицы: Создается третья таблица, которая будет связывать две исходные таблицы (А и Б).
Ключи связующей таблицы: Связующая таблица содержит два внешних ключа: один ссылается на первичный ключ таблицы А, а другой - на первичный ключ таблицы Б.
Связь “1:N”: В каждой из таблиц устанавливается связь “один ко многим” со связующей таблицей.
11. Изменения в БД при заказе нескольких одинаковых блюд

Если клиенты часто заказывают несколько одинаковых блюд, то можно внести следующие изменения в БД:

Таблица “Заказ”:
Добавить поле “Номер заказа” (первичный ключ)
Сохранить “Дата заказа” и “Номер клиента” (внешний ключ, ссылающийся на таблицу Клиенты).
Таблица “Строка заказа” (промежуточная таблица):
Добавить поле “ID записи” (первичный ключ)
Добавить поле “Номер заказа” (внешний ключ, ссылающийся на таблицу Заказ)
Добавить поле “ID блюда” (внешний ключ, ссылающийся на таблицу Блюда)
Добавить поле “Количество” - количество заказанных блюд
Таблица “Блюда”:
Оставить, как есть “ID блюда”, “Наименование блюда” и “Цена блюда”.
